<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<title>Clicker Mobile Bounty</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
  body {
    background-image: url('image/bounty.jpg');
    background-size: cover;
    background-repeat: no-repeat;
    background-position: center;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
    height: 100vh;
    margin: 0;
    font-family: 'Segoe UI', sans-serif;
    overflow-x: hidden;
  }

  h2 {
    color: #FFD700;
    text-shadow: 2px 2px 10px black;
    font-size: 1.8em;
    margin: 15px 0;
    text-align: center;
  }

  #image {
    width: 400px;
    height: 300px;
    object-fit: contain;
    border: 2px solid #fff;
    margin-top: 20px;
    transition: none !important;
    transform: none !important;
    cursor: default;
    touch-action: none;
    -webkit-tap-highlight-color: transparent;
    user-select: none;
  }

  #score {
    color: white;
    font-size: 1.5em;
    margin: 10px 0;
    text-shadow: 1px 1px 5px black;
  }

  #reset-btn {
    margin: 10px 0;
    padding: 8px 12px;
    font-weight: bold;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    background: linear-gradient(90deg, #FF4C4C, #FF7777);
    color: white;
    font-size: 1em;
    width: 80%;
    box-shadow: 0 3px 8px rgba(0,0,0,0.3);
    transition: transform 0.2s, background 0.2s;
  }

  #reset-btn:hover {
    transform: scale(1.05);
    background: linear-gradient(90deg, #cc0000, #ff4c4c);
  }

  #store {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    width: 70%;  /* boutique plus compacte */
    margin-top: 10px;
  }

  .store-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 4px; /* moins d'espace */
    width: 100%;
  }

  .store-item img {
    width: 30px;  /* icône plus petite */
    height: 30px;
    margin-left: 6px;
  }

  .button-store {
    margin: 2px;
    padding: 6px 10px; /* bouton plus petit */
    font-weight: bold;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    background: linear-gradient(90deg, #007BFF, #00BFFF);
    color: white;
    font-size: 0.8em;
    width: 70%; /* réduit largeur */
    box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    transition: transform 0.2s, background 0.2s;
  }

  .button-store:hover {
    transform: scale(1.05);
    background: linear-gradient(90deg, #0056b3, #1E90FF);
  }
</style>
</head>
<body>

<h2>Bounty Clicker Mobile</h2>
<div id="score">Click : 0</div>
<img id="image" src="image/bounty.jpg" alt="Bounty">

<!-- Bouton Réinitialiser -->
<button id="reset-btn">Réinitialiser le jeu</button>

<div id="store"></div>

<script>
let score = 0;
let clickValue = 1;

// Objets du magasin
const items = [
  {name:"Gamelle de croquette", price:10, cps:0, clickMultiplier:1, icon:'image/icon1.png', count:0},
  {name:"Paquet de croquette", price:50, cps:1, clickMultiplier:0, icon:'image/icon2.png', count:0},
  {name:"Magasin de croquettes", price:200, cps:5, clickMultiplier:0, icon:'image/icon3.png', count:0},
  {name:"Supermarché de croquette", price:500, cps:10, clickMultiplier:0, icon:'image/icon4.png', count:0},
  {name:"Hypermarché de croquettes", price:1200, cps:25, clickMultiplier:0, icon:'image/icon5.png', count:0},
  {name:"Entrepôt de croquettes", price:3000, cps:50, clickMultiplier:0, icon:'image/icon6.png', count:0},
  {name:"Usine de croquettes", price:7000, cps:100, clickMultiplier:0, icon:'image/icon7.png', count:0},
  {name:"Dimension de croquettes", price:15000, cps:250, clickMultiplier:0, icon:'image/icon8.png', count:0},
  {name:"Univers de croquettes", price:50000, cps:500, clickMultiplier:0, icon:'image/icon9.png', count:0},
];

// Restauration des données depuis localStorage
if(localStorage.getItem('clickerData')){
  const data = JSON.parse(localStorage.getItem('clickerData'));
  score = data.score;
  clickValue = data.clickValue;
  items.forEach((item, index)=>{
    if(data.items[index]){
      item.count = data.items[index].count;
      item.price = data.items[index].price;
    }
  });
}

// Fonction sauvegarde
function saveData(){
  const data = {
    score: score,
    clickValue: clickValue,
    items: items.map(item=>({count:item.count, price:item.price}))
  };
  localStorage.setItem('clickerData', JSON.stringify(data));
}

// Création des boutons du magasin
const storeDiv = document.getElementById('store');
items.forEach((item, index)=>{
  const div = document.createElement('div');
  div.className = 'store-item';
  div.innerHTML = `
    <button class="button-store" id="btn-${index}">${item.name} (${item.price})</button>
    <img src="${item.icon}" alt="${item.name} Icon">
  `;
  storeDiv.appendChild(div);

  document.getElementById(`btn-${index}`).addEventListener('click', ()=>{
    if(score >= item.price){
      score -= item.price;
      item.count++;
      item.price = Math.floor(item.price * 1.2);
      if(item.clickMultiplier > 0) clickValue += item.clickMultiplier;
      saveData(); // sauvegarde immédiate après achat
    }
    updateScore();
    updateStore();
  });
});

// Réinitialiser le jeu
document.getElementById('reset-btn').addEventListener('click', ()=>{
  if(confirm("Voulez-vous vraiment réinitialiser le jeu ?")){
    score = 0;
    clickValue = 1;
    items.forEach(item=>{
      item.count = 0;
      if(item.name === "Gamelle de croquette") item.price = 10;
      else item.price = item.price / Math.pow(1.2, item.count);
    });
    localStorage.removeItem('clickerData');
    updateScore();
    updateStore();
  }
});

const scoreDiv = document.getElementById('score');
function updateScore(){
  let cpsTotal = items.reduce((a,b)=>a+b.cps*b.count,0);
  scoreDiv.textContent = `Click : ${score} | CPS : ${cpsTotal}`;
}

function updateStore(){
  items.forEach((item, index)=>{
    document.getElementById(`btn-${index}`).textContent = `${item.name} (${item.price})`;
  });
}

// Click sur l'image
const img = document.getElementById('image');
let canClick = true;
img.addEventListener('click', ()=>{
  if(!canClick) return;
  score += clickValue;
  updateScore();
  saveData(); // sauvegarde immédiate après click
  canClick = false;
  setTimeout(()=>{ canClick = true; }, 300); // 0.3s entre clicks
});

// CPS automatique
setInterval(()=>{
  let totalCPS = items.reduce((a,b)=>a+b.cps*b.count,0);
  score += totalCPS;
  updateScore();
  saveData(); // sauvegarde régulière
},1000);

// Sauvegarde automatique toutes les 1 minute (backup)
setInterval(saveData, 60000);

updateScore();
updateStore();
</script>

</body>
</html>
